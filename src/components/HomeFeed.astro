---
interface Props {
  posts: Array<{
    id: string;
    data: {
      title: string;
      description: string;
      pubDate: string; // We kept string serialization in index.astro for safety, though Astro component can handle Date objects better usually. Let's assume passed as is from index.
      categories: string[];
    };
  }>;
}

const { posts } = Astro.props;

const INITIAL_COUNT = 3;
const initialPosts = posts.slice(0, INITIAL_COUNT);
const hiddenPosts = posts.slice(INITIAL_COUNT);
---

<section>
  <div class="space-y-16">
    {/* Initial Posts */}
    {initialPosts.map((post, index) => (
      <article class="group">
        <a href={`/blog/${post.id}`} class="block mb-4">
          <h2 class="text-3xl font-bold text-white group-hover:text-primary transition-colors duration-300 mb-4">
            {post.data.title}
          </h2>
        </a>
        <p class="text-gray-300 text-lg leading-relaxed mb-6">
          {post.data.description}
        </p>
        <a href={`/blog/${post.id}`} class="text-primary font-bold hover:text-accent transition-colors flex items-center gap-2">
          Read more
          <span class="group-hover:translate-x-1 transition-transform">→</span>
        </a>
      </article>
    ))}

    {/* Hidden Posts Container */}
    <div id="hidden-posts" class="hidden space-y-16">
      {hiddenPosts.map((post, index) => (
        <article class="group">
          <a href={`/blog/${post.id}`} class="block mb-4">
            <h2 class="text-3xl font-bold text-white group-hover:text-primary transition-colors duration-300 mb-4">
              {post.data.title}
            </h2>
          </a>
          <p class="text-gray-300 text-lg leading-relaxed mb-6">
            {post.data.description}
          </p>
          <a href={`/blog/${post.id}`} class="text-primary font-bold hover:text-accent transition-colors flex items-center gap-2">
            Read more
            <span class="group-hover:translate-x-1 transition-transform">→</span>
          </a>
        </article>
      ))}
    </div>
  </div>

  {hiddenPosts.length > 0 && (
    <div class="mt-16 flex justify-center" id="show-more-container">
      <button
        id="show-more-btn"
        class="px-8 py-3 bg-surface hover:bg-surface-hover text-text font-semibold rounded-lg border border-white/10 transition-colors flex items-center gap-2 group cursor-pointer"
      >
        Show more
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transform group-hover:translate-y-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
        </svg>
      </button>
    </div>
  )}
</section>

<script>
  const showMoreBtn = document.getElementById('show-more-btn');
  const showMoreContainer = document.getElementById('show-more-container');
  const hiddenPosts = document.getElementById('hidden-posts');

  if (showMoreBtn && hiddenPosts) {
    showMoreBtn.addEventListener('click', () => {
      // Reveal posts
      hiddenPosts.classList.remove('hidden');
      
      // Hide button
      if (showMoreContainer) {
        showMoreContainer.style.display = 'none';
      }
    });
  }
</script>
